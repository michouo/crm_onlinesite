{% extends "base.html" %}
{% block content %}

<h2 class="mb-4">客戶列表</h2>

<form class="row g-3 mb-4" method="GET">

    <div class="col-auto">
        <input type="text" class="form-control" name="q" value="{{ search }}" placeholder="搜尋姓名/地址/備註">
    </div>

    <div class="col-auto">
        <button class="btn btn-primary" type="submit">搜尋</button>
    </div>

    <div class="col-auto">
        <a href="/list?today=1" class="btn btn-warning">
            今日跟進（{{ today_count }}）
        </a>
    </div>

</form>

<table class="table table-hover table-bordered bg-white">
    <thead class="table-dark">
        <tr>
            <th>姓名</th>
            <th>房屋地址</th>
            <th>戶籍地址</th>
            <th>首次開發</th>
            <th>下次跟進</th>
            <th>備註</th>
            <th>操作</th>
        </tr>
    </thead>

    <tbody>
    {% for c in clients %}
        <tr>
            <td>{{ c.name }}</td>
            <td>{{ c.house_address }}</td>
            <td>{{ c.register_address }}</td>
            <td>{{ c.first_contact.strftime("%Y-%m-%d") }}</td>
            <td>{{ c.next_follow.strftime("%Y-%m-%d") }}</td>
            <td>{{ c.notes }}</td>
            <td>
                <a href="/edit/{{ c.id }}" class="btn btn-sm btn-primary">編輯</a>
                <a href="/delete/{{ c.id }}" class="btn btn-sm btn-danger"
                   onclick="return confirm('確認刪除？')">刪除</a>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>

<div class="mt-3">
    <a href="/export_csv" class="btn btn-success">匯出 CSV</a>
    <a href="/export_excel" class="btn btn-success">匯出 Excel</a>
</div>

{% endblock %}
